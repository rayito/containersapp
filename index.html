<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Containers App</title>
  <script type="text/javascript" src="zepto.min.js"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <script type="text/javascript" src="gmaps.js"></script>
  <link rel="stylesheet" type="text/css" href="map.css" />
  
</head>
<body>
    <h1 class="title"><span class="casered">containers</span><span class="casegreen">app</span></h1>

    <div id="map"></div>  
</body>

<script type="text/javascript">
    var map, lat, lng, cont;
    cont = 0;

    $(function(){

      function enlazarMarcador(e){

       // muestra ruta entre marcas anteriores y actuales
        map.drawRoute({
          origin: [lat, lng],  // origen en coordenadas anteriores
          // destino en coordenadas del click o toque actual
          destination: [e.latLng.lat(), e.latLng.lng()],
          travelMode: 'driving',
          strokeOpacity: 0.6,
          strokeColor: '#0000FF',
          strokeWeight: 5
        });

        lat = e.latLng.lat();   // guarda coords para marca siguiente
        lng = e.latLng.lng();

        if(cont < 3) {
          map.addMarker({ lat: lat, lng: lng, icon: './images/yellow_cont.png'});  // pone marcador en mapa
          cont++;
        } else {
          map.addMarker({ lat: lat, lng: lng, icon: './images/red_cont.png'});  // pone marcador en mapa
        }

      };

      //function locate(){ 
        var lat1 = 37.174758;    // lat & lng of Playmobil Club, Granada (Spain)
        var lng1 = -3.607410;

        var lat2 = 37.178409;
        var lng2 = -3.609165;

        var lat3 = 37.176152;
        var lng3 = -3.604358;

        var lat4 = 37.171886;
        var lng4 = -3.607985;

        map = new GMaps({   // show map with coords [lat, lng]
          el: '#map',
          lat: lat1,
          lng: lng1,
        });

        var m1 = map.addMarker({ lat: lat1, lng: lng1, icon: './images/green_cont.png'});  // marker in [lat, lng]
        var m2 = map.addMarker({ lat: lat2, lng: lng2, icon: './images/red_cont.png'});
        var m3 = map.addMarker({ lat: lat3, lng: lng3, icon: './images/yellow_cont.png'});
        var m4 = map.addMarker({ lat: lat4, lng: lng4, icon: './images/green_cont.png'});

        var markers = [m1, m2, m3, m4];

        // var contentString1 = '<div id="content">'+
        //   '<div id="siteNotice">'+
        //   '</div>'+
        //   '<h1 id="firstHeading" class="firstHeading">Uluru</h1>'+
        //   '<div id="bodyContent">'+
        //   '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
        //   'sandstone rock formation in the southern part of the '+
        //   'Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi) '+
        //   'south west of the nearest large town, Alice Springs; 450&#160;km '+
        //   '(280&#160;mi) by road. Kata Tjuta and Uluru are the two major '+
        //   'features of the Uluru - Kata Tjuta National Park. Uluru is '+
        //   'sacred to the Pitjantjatjara and Yankunytjatjara, the '+
        //   'Aboriginal people of the area. It has many springs, waterholes, '+
        //   'rock caves and ancient paintings. Uluru is listed as a World '+
        //   'Heritage Site.</p>'+
        //   '<p>Attribution: Uluru, <a href="http://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">'+
        //   'http://en.wikipedia.org/w/index.php?title=Uluru</a> '+
        //   '(last visited June 22, 2009).</p>'+
        //   '</div>'+
        //   '</div>';


        // for (var i = 0; i < markers.length; i++) {
        //   var infowindow = new google.maps.InfoWindow({
        //     content: contentString
        //   });
        //   console.log("infowindow for marker m" + i);
        //   google.maps.event.addListener(markers[i], 'click', function() {
        //     infowindow.open(map, markers[i]);
        //     console.log("event.addListener created for m" + i);
        //   });
        // };

        //var s = 
        // DOM
        //var el1 = document.createElement(s);

        var contentString1 = '<div id="w"><h2><span class="casered">containers</span><span class="casegreen">app</span></h2>' +
                             '<div id="bodyContent">' +
                             '<b>Container01</b>' +
                             '<p>Location: ' + lat1 + '°, ' + lng1 + '°</p></div>' +
                             '<div id="filling">Filling level: 25%</div><div id="pic"><img src="./images/green_cont.png"></div></div>';

        var contentString2 = '<div id="w"><h2><span class="casered">containers</span><span class="casegreen">app</span></h2>' +
                             '<div id="bodyContent">' +
                             '<b>Container02</b>' +
                             '<p>Location: ' + lat2 + '°, ' + lng2 + '°</p></div>' +
                             '<div id="filling">Filling level: 75%</div><div id="pic"><img src="./images/red_cont.png"></div></div>';
         
        var contentString3 = '<div id="w"><h2><span class="casered">containers</span><span class="casegreen">app</span></h2>' +
                             '<div id="bodyContent">' +
                             '<b>Container03</b>' +
                             '<p>Location: ' + lat3 + '°, ' + lng3 + '°</p></div>' +
                             '<div id="filling">Filling level: 50%</div><div id="pic"><img src="./images/yellow_cont.png"></div></div>';
            
        var contentString4 = '<div id="w"><h2><span class="casered">containers</span><span class="casegreen">app</span></h2>' +
                             '<div id="bodyContent">' +
                             '<b>Container04</b>' +
                             '<p>Location: ' + lat4 + '°, ' + lng4 + '°</p></div>' +
                             '<div id="filling">Filling level: 0%</div><div id="pic"><img src="./images/green_cont.png"></div></div>';


        var infowindow1 = new google.maps.InfoWindow({
          content: contentString1
        });
        google.maps.event.addListener(m1, 'click', function() {
          infowindow1.content = contentString1;
          infowindow1.open(map, m1);
        });

        // var infowindow2 = new google.maps.InfoWindow({
        //   content: contentString2
        // });
        google.maps.event.addListener(m2, 'click', function() {
          infowindow1.content = contentString2;
          infowindow1.open(map, m2);
        });

        // var infowindow3 = new google.maps.InfoWindow({
        //   content: contentString3
        // });
        google.maps.event.addListener(m3, 'click', function() {
          infowindow1.content = contentString3;
          infowindow1.open(map, m3);
        });

        // var infowindow4 = new google.maps.InfoWindow({
        //   content: contentString4
        // });
        google.maps.event.addListener(m4, 'click', function() {
          infowindow1.content = contentString4;
          infowindow1.open(map, m4);
        });

      //};

      //locate();
    });
  </script>

</html>